<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hóa Học 9 - Tửu Dược (Alcohol) - Lâm Tiên Sinh</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'paper': '#f5e6d3', // Màu giấy cũ
                        'paper-dark': '#e6d2b5',
                        'ink': '#2c1810',   // Màu mực tàu
                        'wood': '#8d6e63',  // Màu gỗ
                        'wood-dark': '#5d4037',
                        'seal': '#b71c1c',  // Màu đỏ dấu triện
                        'jade': '#43a047',  // Màu ngọc bích
                        'gold': '#f9a825',  // Màu vàng kim
                    },
                    fontFamily: {
                        'serif': ['"Noto Serif"', 'serif'],
                        'calligraphy': ['"Patrick Hand"', 'cursive'],
                    }
                }
            }
        }
    </script>
    
    <!-- MathJax Configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            chtml: {
                displayOverflow: 'linebreak'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

    <!-- Three.js for 3D Models -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Noto+Serif:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Noto Serif', serif;
            background-color: #f5e6d3;
            background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png'); /* Giả lập giấy cũ */
            color: #2c1810;
        }
        
        /* Font thư pháp cho tiêu đề */
        .title-font {
            font-family: 'Patrick Hand', cursive;
        }

        /* Scroll Styling (Cuộn giấy) */
        .scroll-container {
            background-color: #fffbf0;
            border: 1px solid #d7ccc8;
            box-shadow: 
                0 0 0 4px #f5e6d3,
                0 0 0 6px #5d4037,
                0 10px 20px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .scroll-container::before, .scroll-container::after {
            content: '';
            position: absolute;
            height: 100%;
            width: 20px;
            top: 0;
            background: linear-gradient(to right, rgba(0,0,0,0.1), transparent);
            z-index: 10;
            pointer-events: none;
        }
        .scroll-container::before { left: 0; }
        .scroll-container::after { right: 0; background: linear-gradient(to left, rgba(0,0,0,0.1), transparent); }

        /* Active Tab Styles - Desktop */
        .active-tab {
            background-color: #5d4037; /* wood-dark */
            color: #f5e6d3; /* paper */
            border-bottom: 4px solid #b71c1c; /* seal red */
            transform: translateY(-4px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        /* Active Tab Styles - Mobile */
        .active-mobile-tab {
            background-color: #efebe9; 
            color: #b71c1c; 
            border-left: 4px solid #5d4037; 
            font-weight: bold;
            background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png');
        }

        /* Buttons RPG Style */
        .btn-rpg-primary {
            background: linear-gradient(to bottom, #8d6e63, #5d4037);
            border: 2px solid #3e2723;
            color: #fffbf0;
            text-shadow: 1px 1px 2px black;
            box-shadow: 0 4px 0 #3e2723, 0 5px 10px rgba(0,0,0,0.3);
            transition: all 0.1s;
        }
        .btn-rpg-primary:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #3e2723;
        }

        .btn-rpg-action {
            background: linear-gradient(to bottom, #b71c1c, #8a0e0e);
            border: 2px solid #570808;
            color: #ffd700;
        }

        /* Cover Page Transition */
        .cover-exit {
            transition: all 800ms cubic-bezier(0.68, -0.55, 0.27, 1.55);
            opacity: 0;
            transform: translateY(-100%) scale(0.9);
        }

        /* Custom Animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes ink-spread {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 0.1; }
        }

        /* Decorative Corners */
        .corner-decoration {
            position: absolute;
            width: 40px;
            height: 40px;
            border: 3px solid #b71c1c;
            z-index: 0;
        }
        .corner-tl { top: 10px; left: 10px; border-right: none; border-bottom: none; }
        .corner-tr { top: 10px; right: 10px; border-left: none; border-bottom: none; }
        .corner-bl { bottom: 10px; left: 10px; border-right: none; border-top: none; }
        .corner-br { bottom: 10px; right: 10px; border-left: none; border-top: none; }

    </style>
</head>
<body class="overflow-x-hidden text-ink">

    <!-- TRANG BÌA (COVER PAGE) - Phong cách Bí Kíp Võ Công -->
    <div id="cover-page" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-wood-dark text-paper w-full h-screen bg-[url('https://www.transparenttextures.com/patterns/wood-pattern.png')]">
        
        <!-- Border Frame -->
        <div class="absolute inset-4 border-4 border-gold opacity-50 pointer-events-none rounded-lg"></div>
        <div class="absolute inset-6 border-2 border-paper opacity-30 pointer-events-none rounded-lg"></div>

        <div class="text-center p-8 relative z-10 bg-black/30 backdrop-blur-sm rounded-xl border border-wood shadow-2xl max-w-2xl w-full mx-4">
            <div class="w-16 h-16 bg-seal text-paper rounded-full flex items-center justify-center text-3xl font-bold mx-auto mb-4 border-2 border-gold shadow-lg title-font">
                Hóa
            </div>
            
            <h2 class="text-2xl mb-2 title-font text-gold opacity-90">Chào mừng môn sinh đến với</h2>
            <h1 class="text-5xl md:text-7xl font-bold mb-4 text-paper drop-shadow-lg title-font uppercase tracking-wider">
                Lâm Gia Trang
            </h1>
            
            <div class="flex items-center justify-center gap-4 mb-6 opacity-80">
                <span class="h-px w-12 bg-gold"></span>
                <i class="fas fa-scroll text-gold text-xl"></i>
                <span class="h-px w-12 bg-gold"></span>
            </div>

            <h3 class="text-3xl md:text-4xl font-bold mb-6 text-gold title-font">Bí Kíp: Tửu Dược (Alcohol)</h3>
            
            <p class="text-xl italic mb-10 max-w-lg mx-auto font-serif text-gray-300">
                "Vạn vật trong thiên hạ đều có linh tính. Nắm bắt được cấu trúc của chúng, ắt sẽ làm chủ được càn khôn."
            </p>
            
            <button onclick="enterClassroom()" class="btn-rpg-primary px-10 py-4 text-xl font-bold rounded-lg group">
                <span class="flex items-center gap-3">
                    Nhập Môn Luyện Công <i class="fas fa-dragon group-hover:scale-125 transition-transform duration-300"></i>
                </span>
            </button>
        </div>
    </div>

    <!-- MAIN CONTENT CONTAINER -->
    <div id="main-interface" class="min-h-screen flex flex-col transition-opacity duration-700">
        
        <!-- MOBILE HEADER (Fixed Top) -->
        <div class="lg:hidden fixed top-0 left-0 right-0 bg-wood-dark text-paper shadow-md z-40 px-4 py-3 flex justify-between items-center border-b-2 border-gold">
            <div class="flex items-center gap-2">
                <div class="bg-paper text-ink w-8 h-8 rounded flex items-center justify-center font-bold border border-gold">L</div>
                <span class="font-bold text-lg title-font">Lâm Tiên Sinh</span>
            </div>
            <button id="hamburger-button" onclick="toggleMobileMenu()" class="text-gold focus:outline-none p-2 border border-transparent hover:border-gold rounded">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </div>

        <!-- MOBILE SIDEBAR MENU (Cuộn tre) -->
        <div id="mobile-menu" class="fixed inset-y-0 left-0 w-64 bg-paper shadow-2xl z-50 transform -translate-x-full transition-transform duration-300 lg:hidden flex flex-col border-r-4 border-wood-dark bg-[url('https://www.transparenttextures.com/patterns/wood-pattern.png')]">
            <div class="p-4 border-b-2 border-wood-dark flex justify-between items-center bg-wood text-paper">
                <span class="font-bold text-xl title-font">Bản Đồ Tu Luyện</span>
                <button id="close-menu-button" onclick="toggleMobileMenu()" class="text-paper hover:text-gold transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="flex flex-col p-2 gap-2 mt-2">
                <button id="mob-tab-intro" onclick="switchTab('intro')" class="mobile-tab-btn text-left px-4 py-3 rounded border border-transparent hover:border-wood text-ink font-serif hover:bg-paper-dark transition active-mobile-tab">
                    <i class="fas fa-scroll mr-2 text-wood-dark"></i> Tàng Thư Các
                </button>
                <button id="mob-tab-1" onclick="switchTab('tab1')" class="mobile-tab-btn text-left px-4 py-3 rounded border border-transparent hover:border-wood text-ink font-serif hover:bg-paper-dark transition">
                    <i class="fas fa-project-diagram mr-2 text-wood-dark"></i> Cấu Trúc Pháp Trận
                </button>
                <button id="mob-tab-2" onclick="switchTab('tab2')" class="mobile-tab-btn text-left px-4 py-3 rounded border border-transparent hover:border-wood text-ink font-serif hover:bg-paper-dark transition">
                    <i class="fas fa-water mr-2 text-wood-dark"></i> Đặc Tính Thủy Hỏa
                </button>
                <button id="mob-tab-3" onclick="switchTab('tab3')" class="mobile-tab-btn text-left px-4 py-3 rounded border border-transparent hover:border-wood text-ink font-serif hover:bg-paper-dark transition">
                    <i class="fas fa-flask mr-2 text-wood-dark"></i> Biến Hóa Chi Thuật
                </button>
                <div class="h-px bg-wood my-2 opacity-50"></div>
                <button id="mob-tab-test" onclick="switchTab('test')" class="mobile-tab-btn text-left px-4 py-3 rounded border border-transparent hover:border-seal text-seal font-bold font-serif hover:bg-red-50 transition">
                    <i class="fas fa-gavel mr-2"></i> Đại Sát Hạch
                </button>
            </div>
        </div>
        <!-- Overlay -->
        <div id="menu-overlay" onclick="toggleMobileMenu()" class="fixed inset-0 bg-black bg-opacity-70 z-40 hidden lg:hidden backdrop-blur-sm"></div>

        <!-- DESKTOP NAVIGATION (Thẻ bài gỗ) -->
        <nav class="hidden lg:flex bg-transparent sticky top-4 z-30 justify-center gap-4 px-4 pt-4">
            <button id="desk-tab-intro" onclick="switchTab('intro')" class="tab-btn active-tab px-6 py-3 rounded bg-wood text-paper-dark font-bold hover:bg-wood-dark transition border-2 border-wood-dark shadow-lg">
                <i class="fas fa-torii-gate mr-1"></i> Tàng Thư Các
            </button>
            <button id="desk-tab-1" onclick="switchTab('tab1')" class="tab-btn px-6 py-3 rounded bg-paper-dark text-ink font-bold hover:bg-wood hover:text-paper transition border-2 border-wood shadow-lg">
                <i class="fas fa-atom mr-1"></i> Cấu Trúc
            </button>
            <button id="desk-tab-2" onclick="switchTab('tab2')" class="tab-btn px-6 py-3 rounded bg-paper-dark text-ink font-bold hover:bg-wood hover:text-paper transition border-2 border-wood shadow-lg">
                <i class="fas fa-tint mr-1"></i> Vật Lý
            </button>
            <button id="desk-tab-3" onclick="switchTab('tab3')" class="tab-btn px-6 py-3 rounded bg-paper-dark text-ink font-bold hover:bg-wood hover:text-paper transition border-2 border-wood shadow-lg">
                <i class="fas fa-fire-alt mr-1"></i> Hóa Học
            </button>
            <button id="desk-tab-test" onclick="switchTab('test')" class="tab-btn px-6 py-3 rounded bg-seal text-white font-bold hover:bg-red-900 transition border-2 border-red-900 shadow-lg transform hover:-translate-y-1">
                <i class="fas fa-dragon mr-1"></i> Sát Hạch
            </button>
        </nav>

        <!-- CONTENT AREA -->
        <main class="flex-grow container mx-auto p-4 lg:p-8 mt-16 lg:mt-4">
            
            <!-- Tab: Giới thiệu -->
            <div id="content-intro" class="tab-content block animate-fade-in">
                <div class="scroll-container rounded-lg p-8 lg:p-12 relative overflow-hidden">
                    <div class="corner-decoration corner-tl"></div>
                    <div class="corner-decoration corner-tr"></div>
                    <div class="corner-decoration corner-bl"></div>
                    <div class="corner-decoration corner-br"></div>

                    <div class="flex flex-col items-center gap-10 relative z-10">
                        <div class="w-full">
                            <h2 class="text-4xl font-bold text-seal mb-6 title-font border-b-2 border-wood inline-block pb-2">Lời Giáo Huấn Của Tiên Sinh</h2>
                            
                            <div class="p-6 bg-paper-dark rounded shadow-inner border border-wood italic text-ink text-xl leading-relaxed font-serif relative">
                                <i class="fas fa-quote-left absolute -top-3 -left-3 text-4xl text-wood opacity-20"></i>
                                <p class="mb-4">"Chư vị môn sinh, hôm nay chúng ta sẽ cùng đàm đạo về một loại dược thủy có tên là <strong class="text-seal">Rượu Etylic (Tửu)</strong>."</p>
                                <p>"Tửu, vừa là thuốc tiên nếu dùng đúng cách, vừa là độc dược thiêu đốt tâm can nếu lạm dụng. Nó có thể hòa tan cùng nước như tri kỷ, nhưng cũng có thể bùng cháy dữ dội như hỏa long. Hãy cẩn trọng mà lĩnh hội!"</p>
                            </div>
                            
                            <div class="mt-8 grid grid-cols-2 gap-4">
                                <div class="bg-wood text-paper p-4 rounded border-2 border-wood-dark text-center shadow-md">
                                    <p class="text-sm opacity-75 uppercase">Pháp Danh</p>
                                    <p class="text-2xl font-bold font-mono mt-1">$C_2H_6O$</p>
                                </div>
                                <div class="bg-wood text-paper p-4 rounded border-2 border-wood-dark text-center shadow-md">
                                    <p class="text-sm opacity-75 uppercase">Trọng Lượng</p>
                                    <p class="text-2xl font-bold font-mono mt-1">46 đvC</p>
                                </div>
                            </div>

                            <div class="mt-10 text-center">
                                <button onclick="switchTab('tab1')" class="btn-rpg-primary px-8 py-3 rounded font-bold inline-flex items-center">
                                    Tiến vào Cấu Trúc Pháp Trận <i class="fas fa-chevron-right ml-2 text-xs"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 1: Cấu tạo phân tử -->
            <div id="content-tab1" class="tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Kiến thức -->
                    <div class="scroll-container rounded-lg p-6 lg:p-8">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-wood text-paper rounded-full flex items-center justify-center font-bold text-xl border-2 border-gold shadow-md mr-4">I</div>
                            <h2 class="text-3xl font-bold text-ink title-font">Bí Mật Linh Đơn</h2>
                        </div>
                        
                        <div class="space-y-6 text-lg">
                            <p>Pháp trận cấu tạo của Tửu Dược (Rượu Etylic) được sắp xếp như sau:</p>
                            <div class="bg-paper-dark p-6 rounded border-2 border-dashed border-wood text-center font-mono text-2xl text-seal font-bold shadow-inner">
                                $CH_3 - CH_2 - OH$
                            </div>
                            
                            <div class="bg-red-50 p-4 rounded border-l-4 border-seal text-ink">
                                <h4 class="font-bold text-seal mb-1"><i class="fas fa-exclamation-circle"></i> Điểm Huyệt Quan Trọng:</h4>
                                <p>Trong pháp trận này, có một nguyên tử <strong>Hydro</strong> tách biệt, không gắn với Carbon mà gắn trực tiếp vào Oxi, tạo thành nhóm <strong class="text-seal underline decoration-wavy">-OH (Hiđroxyl)</strong>.</p>
                            </div>

                            <div class="bg-wood/10 p-4 rounded border border-wood italic text-wood-dark text-base">
                                <i class="fas fa-comment-dots text-wood mr-2"></i>
                                <strong>Lâm Tiên Sinh giảng giải:</strong> "Cái đuôi $OH$ này chính là 'tử huyệt' khiến rượu etylic có tính linh hoạt. Nó giống như chuôi kiếm, là nơi quyết định các chiêu thức phản ứng hóa học sau này."
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mô phỏng 3D -->
                    <div class="scroll-container rounded-lg p-6 flex flex-col items-center justify-center bg-gradient-to-br from-paper to-gray-200">
                        <div class="flex justify-between w-full items-center mb-4 border-b border-wood pb-2">
                            <h3 class="text-xl font-bold text-wood-dark title-font">Pháp Bảo: Mô Hình 3D</h3>
                            <span class="text-xs text-wood italic"><i class="fas fa-mouse pointer-events-none"></i> Kéo để xoay - Lăn chuột để zoom</span>
                        </div>
                        
                        <!-- 3D Container -->
                        <div id="molecule-3d-container" class="w-full h-64 lg:h-80 rounded-lg shadow-inner border-2 border-wood-dark bg-black/10 relative overflow-hidden">
                            <!-- Canvas will be injected here -->
                            <div id="loading-3d" class="absolute inset-0 flex items-center justify-center text-wood font-bold">
                                <i class="fas fa-circle-notch fa-spin mr-2"></i> Đang triệu hồi pháp trận...
                            </div>
                        </div>

                        <div class="mt-4 flex gap-4 text-sm font-serif italic text-wood-dark">
                            <span class="flex items-center"><span class="w-3 h-3 rounded-full bg-[#212121] border border-gray-600 mr-1"></span> C (Hắc)</span>
                            <span class="flex items-center"><span class="w-3 h-3 rounded-full bg-[#b71c1c] border border-red-900 mr-1"></span> O (Huyết)</span>
                            <span class="flex items-center"><span class="w-3 h-3 rounded-full bg-[#fffbf0] border border-gray-400 mr-1"></span> H (Bạch)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Tính chất vật lý -->
            <div id="content-tab2" class="tab-content hidden">
                 <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Kiến thức -->
                    <div class="scroll-container rounded-lg p-6 lg:p-8">
                         <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-wood text-paper rounded-full flex items-center justify-center font-bold text-xl border-2 border-gold shadow-md mr-4">II</div>
                            <h2 class="text-3xl font-bold text-ink title-font">Đặc Tính Thủy Hỏa</h2>
                        </div>
                        
                        <div class="bg-paper-dark p-4 rounded border border-wood mb-4">
                            <ul class="list-none space-y-4 text-ink">
                                <li class="flex items-start">
                                    <i class="fas fa-wine-bottle text-wood-dark mt-1 mr-3 text-lg"></i>
                                    <span>Là chất lỏng, không màu, nhẹ hơn nước ("Khinh thủy").</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-temperature-high text-seal mt-1 mr-3 text-lg"></i>
                                    <span>Sôi ở $78.3^\circ C$ (Thấp hơn nước).</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-infinity text-jade mt-1 mr-3 text-lg"></i>
                                    <span>Hòa tan vô hạn trong nước ("Vô cực dung hợp").</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-chart-pie text-gold mt-1 mr-3 text-lg"></i>
                                    <span><strong>Độ rượu:</strong> Là số ml rượu nguyên chất trong 100ml hỗn hợp.</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="p-4 bg-yellow-50 rounded-lg text-sm border-2 border-yellow-200 text-center relative mt-6">
                             <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-yellow-200 px-3 py-1 rounded text-xs font-bold uppercase tracking-wider text-yellow-800">Ví dụ thực tiễn</div>
                             <strong>Rượu $45^\circ$</strong> tức là trong 100 chén rượu thì có 45 chén là cốt rượu tinh khiết (nguyên chất).
                        </div>
                    </div>

                    <!-- Mô phỏng SVG: Hòa tan -->
                    <div class="scroll-container rounded-lg p-6 flex flex-col items-center">
                        <h3 class="text-xl font-bold text-wood-dark mb-6 title-font border-b border-wood inline-block">Mô Phỏng Dung Hợp</h3>
                        <svg width="300" height="250" viewBox="0 0 300 250" class="w-full h-auto max-w-xs drop-shadow-md">
                            <!-- Chén cổ/Beaker style -->
                            <path d="M70,20 L70,210 Q70,240 100,240 L200,240 Q230,240 230,210 L230,20" fill="none" stroke="#5d4037" stroke-width="6" />
                            <path d="M65,20 L235,20" fill="none" stroke="#5d4037" stroke-width="2" stroke-linecap="round"/>
                            
                            <!-- Liquid Level -->
                            <path d="M75,210 L75,100 L225,100 L225,210 Q225,235 200,235 L100,235 Q75,235 75,210" fill="#e1f5fe" opacity="0.9" />
                            
                            <!-- Nước (Blue ink) -->
                            <circle cx="100" cy="200" r="5" fill="#0288d1" class="animate-[float_2s_infinite]" />
                            <circle cx="150" cy="180" r="6" fill="#0288d1" class="animate-[float_2.5s_infinite]" />
                            <circle cx="200" cy="210" r="5" fill="#0288d1" class="animate-[float_3s_infinite]" />
                            
                            <!-- Rượu (Jade Green - pouring in) -->
                            <g id="pouring-molecules">
                                <circle cx="150" cy="40" r="6" fill="#43a047">
                                    <animate attributeName="cy" from="20" to="150" dur="2s" repeatCount="indefinite" />
                                    <animate attributeName="opacity" values="1;1;0" dur="2s" repeatCount="indefinite" />
                                </circle>
                                <circle cx="140" cy="30" r="5" fill="#43a047">
                                    <animate attributeName="cy" from="10" to="160" dur="2.3s" repeatCount="indefinite" />
                                    <animate attributeName="opacity" values="1;1;0" dur="2.3s" repeatCount="indefinite" />
                                </circle>
                            </g>

                            <!-- Mixed Molecules -->
                            <circle cx="120" cy="150" r="6" fill="#43a047" opacity="0">
                                <animate attributeName="opacity" values="0;1;1" dur="4s" repeatCount="indefinite" />
                                <animate attributeName="cx" values="120;200;80;120" dur="10s" repeatCount="indefinite" />
                                <animate attributeName="cy" values="150;120;180;150" dur="10s" repeatCount="indefinite" />
                            </circle>
                            <circle cx="180" cy="130" r="5" fill="#43a047" opacity="0">
                                <animate attributeName="opacity" values="0;1;1" dur="3s" repeatCount="indefinite" />
                                <animate attributeName="cx" values="180;100;220;180" dur="12s" repeatCount="indefinite" />
                            </circle>
                        </svg>
                        <p class="text-sm text-center text-wood-dark mt-4 font-serif italic">"Thanh thủy (Xanh lam) và Tửu (Ngọc bích) hòa quyện không phân biệt."</p>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Tính chất hóa học -->
            <div id="content-tab3" class="tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Kiến thức -->
                    <div class="scroll-container rounded-lg p-6 lg:p-8">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-wood text-paper rounded-full flex items-center justify-center font-bold text-xl border-2 border-gold shadow-md mr-4">III</div>
                            <h2 class="text-3xl font-bold text-ink title-font">Biến Hóa Chi Thuật</h2>
                        </div>
                        
                        <!-- P1 -->
                        <div class="mb-8 relative pl-4 border-l-2 border-wood-dark">
                            <h3 class="font-bold text-xl text-seal mb-2 title-font">1. Hỏa Công (Phản ứng cháy)</h3>
                            <p class="text-ink mb-2">Tửu gặp lửa sẽ bùng cháy với ngọn lửa xanh lam, tỏa nhiệt lượng cực lớn.</p>
                            <div class="bg-ink p-4 rounded text-paper-dark font-mono text-base shadow-inner border border-wood">
                                $$C_2H_6O + 3O_2 \xrightarrow{t^\circ} 2CO_2 + 3H_2O$$
                            </div>
                        </div>

                        <!-- P2 -->
                        <div class="relative pl-4 border-l-2 border-wood-dark">
                            <h3 class="font-bold text-xl text-seal mb-2 title-font">2. Tác dụng với Natri</h3>
                            <p class="text-ink mb-2">Khi gặp kim loại Natri, Tửu sẽ giải phóng khí Hydro (Khinh khí).</p>
                            <div class="bg-ink p-4 rounded text-paper-dark font-mono text-base shadow-inner border border-wood">
                                $$2C_2H_5OH + 2Na \longrightarrow 2C_2H_5ONa + H_2 \uparrow$$
                            </div>
                            <p class="text-xs text-wood mt-2 italic">* $C_2H_5ONa$: Natri etylat</p>
                        </div>
                        
                        <div class="mt-6 bg-paper-dark p-4 rounded border-2 border-wood-dark relative">
                             <div class="absolute -top-3 -right-3 bg-wood text-paper text-xs px-2 py-1 rounded">Bí mật</div>
                             <p class="italic text-ink font-serif">
                                "Tửu tuy nóng nảy (dễ cháy) nhưng lại rất hào phóng. Khi gặp bằng hữu Natri, nó sẵn sàng tặng đi nguyên tử Hydro quý giá của mình."
                            </p>
                        </div>
                    </div>

                    <!-- Mô phỏng SVG: Phản ứng cháy -->
                    <div class="scroll-container rounded-lg p-6 flex flex-col items-center justify-center bg-[#212121]">
                        <h3 class="text-xl font-bold text-paper mb-6 title-font border-b border-paper inline-block">Mô Phỏng Hỏa Công</h3>
                        <svg width="300" height="200" viewBox="0 0 300 200" class="w-full h-auto max-w-xs rounded-lg">
                            <!-- Wick/Dish (Ancient Lamp style) -->
                            <path d="M80,160 Q150,180 220,160 L210,140 Q150,160 90,140 Z" fill="#5d4037" />
                            <rect x="140" y="140" width="20" height="20" fill="#3e2723" />
                            
                            <!-- Flame (Blue/Green for Alchemy fire) -->
                            <path d="M150,150 Q120,100 150,20 Q180,100 150,150" fill="url(#spiritFlame)">
                                <animate attributeName="d" 
                                    values="M150,150 Q120,100 150,20 Q180,100 150,150; M150,150 Q130,90 145,30 Q170,90 150,150; M150,150 Q120,100 150,20 Q180,100 150,150" 
                                    dur="0.6s" repeatCount="indefinite" />
                            </path>
                            
                            <!-- Particles Rising -->
                            <g class="animate-[bubble-rise_2s_infinite]">
                                <text x="140" y="80" fill="#e0f2fe" font-size="12" font-family="serif">CO2</text>
                            </g>
                            <g class="animate-[bubble-rise_2.5s_infinite]" style="animation-delay: 0.5s">
                                <text x="160" y="100" fill="#81d4fa" font-size="12" font-family="serif">H2O</text>
                            </g>
                            <g class="animate-[bubble-rise_1.8s_infinite]" style="animation-delay: 1s">
                                <text x="130" y="60" fill="#ffecb3" font-size="10" font-family="serif">Nhiệt</text>
                            </g>

                            <defs>
                                <linearGradient id="spiritFlame" x1="0%" y1="100%" x2="0%" y2="0%">
                                    <stop offset="0%" stop-color="#0277bd" /> <!-- Dark Blue base -->
                                    <stop offset="60%" stop-color="#4fc3f7" /> <!-- Light Blue mid -->
                                    <stop offset="100%" stop-color="#ffffff" opacity="0.8"/> <!-- White tip -->
                                </linearGradient>
                            </defs>
                        </svg>
                        <p class="text-sm text-center text-gray-400 mt-4 font-serif italic">Ngọn lửa thanh thiên thiêu đốt mọi tạp chất.</p>
                    </div>
                </div>
                
                <!-- Nút chuyển sang bài kiểm tra -->
                <div class="mt-10 flex justify-center">
                    <button onclick="switchTab('test')" class="btn-rpg-action px-10 py-4 rounded-lg font-bold text-xl shadow-xl transform transition hover:-translate-y-2 group">
                        <span class="flex items-center gap-3">
                            <i class="fas fa-fist-raised"></i> Tham Gia Sát Hạch <i class="fas fa-scroll group-hover:rotate-12 transition-transform"></i>
                        </span>
                    </button>
                </div>
            </div>

            <!-- Tab: Kiểm tra -->
            <div id="content-test" class="tab-content hidden h-full">
                <!-- Adjusted height for mobile to fit viewport better: h-[calc(100vh-120px)] on mobile -->
                <div class="scroll-container rounded-lg p-1 lg:p-4 h-[calc(100vh-100px)] lg:h-[80vh] flex flex-col bg-paper">
                    <!-- Cleaned up: Removed header (Title/Reset) and footer (Buttons) -->
                    
                    <!-- Iframe Container: Full height of the parent scroll container -->
                    <div class="flex-grow border-2 lg:border-4 border-double border-wood rounded overflow-hidden relative bg-white shadow-inner w-full">
                        <iframe src="test.html" class="w-full h-full" title="Bài kiểm tra" style="border:0; -webkit-overflow-scrolling: touch; display: block;"></iframe>
                        <!-- Fallback visual -->
                        <div class="absolute inset-0 flex flex-col items-center justify-center -z-10 text-wood opacity-50 pointer-events-none">
                            <i class="fas fa-scroll text-4xl lg:text-6xl mb-4"></i>
                            <p class="font-serif text-lg lg:text-xl">Đang trải giấy mực...</p>
                        </div>
                    </div>
                    
                </div>
            </div>

        </main>
        
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // 1. Cover Page Animation
        function enterClassroom() {
            const cover = document.getElementById('cover-page');
            const main = document.getElementById('main-interface');
            
            // Add exit class to cover
            cover.classList.add('cover-exit');
            
            // Remove cover from DOM after animation completes
            setTimeout(() => {
                cover.style.display = 'none';
            }, 800);
        }

        // 3D Scene Global Variables
        let scene, camera, renderer, moleculeGroup, controls;
        let is3DInitialized = false;
        let animationFrameId;

        // Initialize 3D Scene
        function init3DMolecule() {
            if (is3DInitialized) return;
            
            const container = document.getElementById('molecule-3d-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            // Scene
            scene = new THREE.Scene();
            // Background transparent to blend with 'paper' style or light color
            scene.background = new THREE.Color(0xf5e6d3); // Match paper color
            
            // Camera
            camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
            camera.position.set(0, 2, 8);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(width, height);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);

            // Lighting (Ancient style - warm light)
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffd700, 0.8); // Gold light
            directionalLight.position.set(5, 5, 5);
            directionalLight.castShadow = true;
            scene.add(directionalLight);

            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // --- Build Molecule: Ethanol (C2H5OH) ---
            moleculeGroup = new THREE.Group();

            // Materials
            const carbonMat = new THREE.MeshPhongMaterial({ color: 0x212121, shininess: 30 }); // Black/Dark Wood
            const oxygenMat = new THREE.MeshPhongMaterial({ color: 0xb71c1c, shininess: 50 }); // Seal Red
            const hydrogenMat = new THREE.MeshPhongMaterial({ color: 0xfffbf0, shininess: 10 }); // Paper White
            const bondMat = new THREE.MeshPhongMaterial({ color: 0x5d4037 }); // Wood

            // Helpers
            function createAtom(material, size, x, y, z) {
                const geometry = new THREE.SphereGeometry(size, 32, 32);
                const sphere = new THREE.Mesh(geometry, material);
                sphere.position.set(x, y, z);
                sphere.castShadow = true;
                moleculeGroup.add(sphere);
                return sphere;
            }

            function createBond(start, end) {
                const direction = new THREE.Vector3().subVectors(end, start);
                const length = direction.length();
                
                const geometry = new THREE.CylinderGeometry(0.15, 0.15, length, 16);
                const cylinder = new THREE.Mesh(geometry, bondMat);
                
                // Position midpoint
                const mid = new THREE.Vector3().addVectors(start, end).multiplyScalar(0.5);
                cylinder.position.copy(mid);
                
                // Rotate
                cylinder.quaternion.setFromUnitVectors(new THREE.Vector3(0, 1, 0), direction.clone().normalize());
                
                moleculeGroup.add(cylinder);
            }

            // Coordinates (Approximate for style)
            const c1Pos = new THREE.Vector3(-1.2, 0, 0);
            const c2Pos = new THREE.Vector3(0.3, 0, 0);
            const oPos = new THREE.Vector3(1.3, 0.8, 0); // Angled up
            const hOPos = new THREE.Vector3(2.0, 0.4, 0); // H attached to O

            // Atoms
            createAtom(carbonMat, 0.5, c1Pos.x, c1Pos.y, c1Pos.z); // C1
            createAtom(carbonMat, 0.5, c2Pos.x, c2Pos.y, c2Pos.z); // C2
            createAtom(oxygenMat, 0.45, oPos.x, oPos.y, oPos.z);   // O
            createAtom(hydrogenMat, 0.25, hOPos.x, hOPos.y, hOPos.z); // H on O

            // Hydrogens on C1
            createAtom(hydrogenMat, 0.25, -1.2, 0.9, 0);
            createAtom(hydrogenMat, 0.25, -1.6, -0.5, 0.7);
            createAtom(hydrogenMat, 0.25, -1.6, -0.5, -0.7);

            // Hydrogens on C2
            createAtom(hydrogenMat, 0.25, 0.3, -0.9, 0);
            createAtom(hydrogenMat, 0.25, 0.3, 0.5, 0.9); // 3D effect

            // Bonds
            createBond(c1Pos, c2Pos);
            createBond(c2Pos, oPos);
            createBond(oPos, hOPos);
            
            // Bonds C1-H
            createBond(c1Pos, new THREE.Vector3(-1.2, 0.9, 0));
            createBond(c1Pos, new THREE.Vector3(-1.6, -0.5, 0.7));
            createBond(c1Pos, new THREE.Vector3(-1.6, -0.5, -0.7));
            
            // Bonds C2-H
            createBond(c2Pos, new THREE.Vector3(0.3, -0.9, 0));
            createBond(c2Pos, new THREE.Vector3(0.3, 0.5, 0.9));

            scene.add(moleculeGroup);
            
            // Center camera
            moleculeGroup.position.x = 0; 

            // Remove loading text
            document.getElementById('loading-3d').style.display = 'none';

            is3DInitialized = true;
            animate3D();
        }

        function animate3D() {
            animationFrameId = requestAnimationFrame(animate3D);
            
            if (moleculeGroup) {
                moleculeGroup.rotation.y += 0.005; // Slow rotation
                moleculeGroup.rotation.x = Math.sin(Date.now() * 0.001) * 0.1;
            }
            
            if (controls) controls.update();
            if (renderer && scene && camera) renderer.render(scene, camera);
        }

        // Handle Resize
        window.addEventListener('resize', () => {
            if (!is3DInitialized) return;
            const container = document.getElementById('molecule-3d-container');
            if (container && camera && renderer) {
                const width = container.clientWidth;
                const height = container.clientHeight;
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize(width, height);
            }
        });

        // 2. Tab Switching Logic
        function switchTab(tabId) {
            const tabs = ['intro', 'tab1', 'tab2', 'tab3', 'test'];

            tabs.forEach(t => {
                const content = document.getElementById(`content-${t}`);
                if(content) content.classList.add('hidden');
                
                // Desktop
                const deskBtn = document.getElementById(`desk-tab-${t}`);
                if(deskBtn) {
                    deskBtn.classList.remove('active-tab');
                    deskBtn.classList.add('bg-paper-dark', 'text-ink');
                    deskBtn.classList.remove('bg-wood', 'text-paper-dark');
                    // Reset special styles if any
                    if(t === 'test') {
                         deskBtn.classList.remove('bg-seal', 'text-white');
                         deskBtn.classList.add('bg-seal', 'text-white'); 
                    }
                }

                // Mobile
                const mobBtn = document.getElementById(`mob-tab-${t}`);
                if(mobBtn) {
                    mobBtn.classList.remove('active-mobile-tab');
                }
            });

            // Show content
            const selectedContent = document.getElementById(`content-${tabId}`);
            if(selectedContent) {
                selectedContent.classList.remove('hidden');
                selectedContent.classList.add('block', 'animate-fade-in');
            }

            // Init 3D if Tab 1
            if (tabId === 'tab1') {
                // Short delay to ensure container has rendered dimensions
                setTimeout(init3DMolecule, 100);
            }

            // Active Desktop
            const selectedDeskBtn = document.getElementById(`desk-tab-${tabId}`);
            if(selectedDeskBtn) {
                selectedDeskBtn.classList.add('active-tab');
                selectedDeskBtn.classList.remove('bg-paper-dark', 'text-ink');
                selectedDeskBtn.classList.add('bg-wood', 'text-paper-dark');
                
                if(tabId === 'test') {
                     selectedDeskBtn.classList.add('bg-seal', 'text-white'); 
                }
            }

            // Active Mobile
            const selectedMobBtn = document.getElementById(`mob-tab-${tabId}`);
            if(selectedMobBtn) {
                selectedMobBtn.classList.add('active-mobile-tab');
            }

            // Auto close mobile menu
            const mobileMenu = document.getElementById('mobile-menu');
            if (!mobileMenu.classList.contains('-translate-x-full')) {
                toggleMobileMenu();
            }

            // Scroll top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 3. Mobile Menu Toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const overlay = document.getElementById('menu-overlay');
            
            if (menu.classList.contains('-translate-x-full')) {
                menu.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
            } else {
                menu.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
            }
        }
    </script>
</body>
</html>